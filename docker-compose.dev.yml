version: "3.8"

services:
  node:
    volumes:
      # Bind mount your local source into the container
      - ./nodejs:/usr/src/app
      # Prevent host node_modules from overwriting container deps
      - /usr/src/app/node_modules

    environment:
      - NODE_ENV=development

    ports:
      # Direct access to Node for debugging
      - "3000:3000"

    # Run dev server instead of production start
    command: npm run dev

  nginx:
    # Same external port, but live-editable config/static files
    volumes:
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - ./nginx/public:/usr/share/nginx/html:ro
